
- platform: yr
  name: Weather
  # forecast: 24
  monitored_conditions:
    - temperature
    - symbol
    - precipitation
    - windSpeed
    - pressure
    - windDirection
    - humidity
    - fog
    - cloudiness
    - lowClouds
    - mediumClouds
    - highClouds
    - dewpointTemperature


- platform: template
  sensors:
    away_mode:
      value_template: "{{ states.climate.hallway.attributes.away_mode }}"


- platform: template
  sensors:
    next_sun_event:
      value_template: >-
        {% set next_time = 86400 %}
        {% if as_timestamp(states.sun.sun.attributes.next_noon) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_noon) - as_timestamp(now()) %}
        {% set next_event = 'noon' %}
        {% endif %}
        {% if as_timestamp(states.sun.sun.attributes.next_setting) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_setting) - as_timestamp(now()) %}
        {% set next_event = 'setting' %}
        {% endif %}
        {% if as_timestamp(states.sun.sun.attributes.next_dusk) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_dusk) - as_timestamp(now()) %}
        {% set next_event = 'dusk' %}
        {% endif %}
        {% if as_timestamp(states.sun.sun.attributes.next_midnight) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_midnight) - as_timestamp(now()) %}
        {% set next_event = 'midnight' %}
        {% endif %}
        {% if as_timestamp(states.sun.sun.attributes.next_dawn) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_dawn) - as_timestamp(now()) %}
        {% set next_event = 'dawn' %}
        {% endif %}
        {% if as_timestamp(states.sun.sun.attributes.next_rising) - as_timestamp(now()) < next_time %}
        {% set next_time = as_timestamp(states.sun.sun.attributes.next_rising) - as_timestamp(now()) %}
        {% set next_event = 'rising' %}
        {% endif %}
        {{ next_event }}


- platform: template
  sensors:
    living_room_light_profile:
      value_template: >-
        {% if states.light.living_room.attributes.xy_color == [0.3146,0.3304] %}
        energize
        {% elif states.light.living_room.attributes.xy_color == [0.3682,0.3715] %}
        concentrate
        {% elif states.light.living_room.attributes.xy_color == [0.4452,0.4068] %}
        read
        {% elif states.light.living_room.attributes.xy_color == [0.5014,0.4153] %}
        relax
        {% else %}
        no profile
        {% endif %}


- platform: template
  sensors:
    family_room_light_profile:
      value_template: >-
        {% if states.light.family_room.attributes.xy_color == [0.3146,0.3304] %}
        energize
        {% elif states.light.family_room.attributes.xy_color == [0.3682,0.3715] %}
        concentrate
        {% elif states.light.family_room.attributes.xy_color == [0.4452,0.4068] %}
        read
        {% elif states.light.family_room.attributes.xy_color == [0.5014,0.4153] %}
        relax
        {% else %}
        no profile
        {% endif %}


- platform: template
  sensors:
    outside_light_profile:
      value_template: >-
        {% if states.light.outside.attributes.xy_color == [0.3146,0.3304] %}
        energize
        {% elif states.light.outside.attributes.xy_color == [0.3682,0.3715] %}
        concentrate
        {% elif states.light.outside.attributes.xy_color == [0.4452,0.4068] %}
        read
        {% elif states.light.outside.attributes.xy_color == [0.5014,0.4153] %}
        relax
        {% else %}
        no profile
        {% endif %}


- platform: template
  sensors:
    master_bedroom_light_profile:
      value_template: >-
        {% if states.light.master_bedroom.attributes.xy_color == [0.3146,0.3304] %}
        energize
        {% elif states.light.master_bedroom.attributes.xy_color == [0.3682,0.3715] %}
        concentrate
        {% elif states.light.master_bedroom.attributes.xy_color == [0.4452,0.4068] %}
        read
        {% elif states.light.master_bedroom.attributes.xy_color == [0.5014,0.4153] %}
        relax
        {% else %}
        no profile
        {% endif %}